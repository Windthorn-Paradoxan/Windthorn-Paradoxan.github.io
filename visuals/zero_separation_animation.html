<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero Separation Animation</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #0a0e1a;
            font-family: 'Courier New', monospace;
            color: #e0e0e0;
        }
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.95);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #334155;
            max-width: 400px;
            z-index: 100;
        }
        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.95);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #334155;
            z-index: 100;
        }
        .state-label {
            font-size: 18px;
            color: #06b6d4;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .stat {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 12px;
        }
        .label { color: #94a3b8; }
        .value { color: #e0e0e0; font-weight: bold; font-family: monospace; }
        button {
            background: #1e40af;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
        }
        button:hover { background: #1d4ed8; }
        button.active { background: #10b981; }
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .legend {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #334155;
            font-size: 11px;
            color: #64748b;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            margin-right: 8px;
            border: 1px solid rgba(255,255,255,0.3);
        }
    </style>
</head>
<body>
    <div id="container"></div>
    
    <div id="info">
        <div class="state-label">T₀ Lattice: 27 Signed Zero States</div>
        <div class="stat">
            <span class="label">Current State:</span>
            <span class="value" id="currentState">(0, 0, 0)</span>
        </div>
        <div class="stat">
            <span class="label">State Index:</span>
            <span class="value" id="stateIndex">1/27</span>
        </div>
        <div class="stat">
            <span class="label">k-class:</span>
            <span class="value" id="kClass">N0 (Stillpoint)</span>
        </div>
        <div class="stat">
            <span class="label">α (Form):</span>
            <span class="value" id="alphaValue">0.000</span>
        </div>
        <div class="stat">
            <span class="label">β (Drift):</span>
            <span class="value" id="betaValue">0.000</span>
        </div>
        <div class="stat">
            <span class="label">γ (Closure):</span>
            <span class="value" id="gammaValue">1.000</span>
        </div>
        <div class="stat">
            <span class="label">Separation:</span>
            <span class="value" id="separation">None</span>
        </div>
        
        <div class="legend">
            <strong>Zero Types:</strong>
            <div class="legend-item">
                <div class="legend-color" style="background: #06b6d4;"></div>
                <span>0 (neutral, unsigned)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ef4444;"></div>
                <span>−0 (negative zero)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #10b981;"></div>
                <span>+0 (positive zero)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #a855f7;"></div>
                <span>^ (separated, both ±0)</span>
            </div>
        </div>
    </div>
    
    <div id="controls">
        <div style="margin-bottom: 10px;">
            <button id="playBtn" class="active">▶️ Play</button>
            <button id="resetBtn">⏮️ Reset</button>
            <button id="nextBtn">⏭️ Next</button>
        </div>
        <label style="display: block; margin: 5px 0; color: #94a3b8; font-size: 11px;">
            Animation Speed:
        </label>
        <input type="range" id="speedSlider" min="100" max="2000" value="800" step="100">
        <div style="margin-top: 10px;">
            <button onclick="jumpToState(0)">N0: (0,0,0)</button>
            <button onclick="jumpToState(1)">N1: (+0,0,0)</button>
            <button onclick="jumpToState(7)">N2: (+0,+0,0)</button>
        </div>
        <div style="margin-top: 5px;">
            <button onclick="jumpToState(19)">N3: (+0,+0,+0)</button>
            <button onclick="jumpToState(26)">N5: (−0,−0,−0)</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // T₀ Lattice: All 27 states with signed zeros
        const T0_LATTICE = [
            // State 1: N0 Stillpoint
            {state: [0, 0, 0], signs: [0, 0, 0], k: 0, alpha: 0.000, beta: 0.000, gamma: 1.000, name: "N0: Stillpoint"},
            
            // States 2-7: N1 Single Bias (k=1)
            {state: [1, 0, 0], signs: [1, 0, 0], k: 1, alpha: 0.333, beta: 0.180, gamma: 0.999, name: "N1: +x axis"},
            {state: [-1, 0, 0], signs: [-1, 0, 0], k: 1, alpha: 0.333, beta: 0.180, gamma: 0.999, name: "N1: −x axis"},
            {state: [0, 1, 0], signs: [0, 1, 0], k: 1, alpha: 0.333, beta: 0.180, gamma: 0.999, name: "N1: +y axis"},
            {state: [0, -1, 0], signs: [0, -1, 0], k: 1, alpha: 0.333, beta: 0.180, gamma: 0.999, name: "N1: −y axis"},
            {state: [0, 0, 1], signs: [0, 0, 1], k: 1, alpha: 0.333, beta: 0.180, gamma: 0.999, name: "N1: +z axis"},
            {state: [0, 0, -1], signs: [0, 0, -1], k: 1, alpha: 0.333, beta: 0.180, gamma: 0.999, name: "N1: −z axis"},
            
            // States 8-19: N2/N4 Balanced/Unbalanced Pairs (k=2)
            {state: [1, 1, 0], signs: [1, 1, 0], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N4: (+0,+0,0)"},
            {state: [1, -1, 0], signs: [1, -1, 0], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N2: (+0,−0,0)"},
            {state: [-1, 1, 0], signs: [-1, 1, 0], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N2: (−0,+0,0)"},
            {state: [-1, -1, 0], signs: [-1, -1, 0], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N4: (−0,−0,0)"},
            {state: [1, 0, 1], signs: [1, 0, 1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N4: (+0,0,+0)"},
            {state: [1, 0, -1], signs: [1, 0, -1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N2: (+0,0,−0)"},
            {state: [-1, 0, 1], signs: [-1, 0, 1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N2: (−0,0,+0)"},
            {state: [-1, 0, -1], signs: [-1, 0, -1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N4: (−0,0,−0)"},
            {state: [0, 1, 1], signs: [0, 1, 1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N4: (0,+0,+0)"},
            {state: [0, 1, -1], signs: [0, 1, -1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N2: (0,+0,−0)"},
            {state: [0, -1, 1], signs: [0, -1, 1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N2: (0,−0,+0)"},
            {state: [0, -1, -1], signs: [0, -1, -1], k: 2, alpha: 0.667, beta: 0.420, gamma: 0.996, name: "N4: (0,−0,−0)"},
            
            // States 20-27: N3/N5 Triple Mixed/Same (k=3)
            {state: [1, 1, 1], signs: [1, 1, 1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N5: (+0,+0,+0) max"},
            {state: [1, 1, -1], signs: [1, 1, -1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N3: (+0,+0,−0)"},
            {state: [1, -1, 1], signs: [1, -1, 1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N3: (+0,−0,+0)"},
            {state: [1, -1, -1], signs: [1, -1, -1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N3: (+0,−0,−0)"},
            {state: [-1, 1, 1], signs: [-1, 1, 1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N3: (−0,+0,+0)"},
            {state: [-1, 1, -1], signs: [-1, 1, -1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N3: (−0,+0,−0)"},
            {state: [-1, -1, 1], signs: [-1, -1, 1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N3: (−0,−0,+0)"},
            {state: [-1, -1, -1], signs: [-1, -1, -1], k: 3, alpha: 1.000, beta: 0.720, gamma: 0.992, name: "N5: (−0,−0,−0) min"}
        ];

        let scene, camera, renderer;
        let currentStateIndex = 0;
        let isPlaying = true;
        let animationInterval;
        let cubes = [];
        let axisSpheres = [];

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0e1a);
            
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(5, 4, 6);
            camera.lookAt(0, 0, 0);
            
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('container').appendChild(renderer.domElement);
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0x404040, 2);
            scene.add(ambientLight);
            
            const pointLight = new THREE.PointLight(0xffffff, 1.5, 100);
            pointLight.position.set(10, 10, 10);
            scene.add(pointLight);
            
            // Create visualization
            createLatticeGrid();
            createAxes();
            createAxisSpheres();
            
            // Event listeners
            document.getElementById('playBtn').addEventListener('click', togglePlay);
            document.getElementById('resetBtn').addEventListener('click', reset);
            document.getElementById('nextBtn').addEventListener('click', nextState);
            document.getElementById('speedSlider').addEventListener('input', updateSpeed);
            
            window.addEventListener('resize', onWindowResize, false);
            
            updateVisualization();
            startAnimation();
            animate();
        }

        function createLatticeGrid() {
            // Create all 27 cube positions
            for (let x = -1; x <= 1; x++) {
                for (let y = -1; y <= 1; y++) {
                    for (let z = -1; z <= 1; z++) {
                        const geometry = new THREE.BoxGeometry(0.6, 0.6, 0.6);
                        const material = new THREE.MeshPhongMaterial({
                            color: 0x334155,
                            transparent: true,
                            opacity: 0.1,
                            wireframe: false
                        });
                        const cube = new THREE.Mesh(geometry, material);
                        cube.position.set(x * 2, y * 2, z * 2);
                        
                        // Add wireframe
                        const edges = new THREE.EdgesGeometry(geometry);
                        const line = new THREE.LineSegments(
                            edges,
                            new THREE.LineBasicMaterial({ color: 0x64748b, transparent: true, opacity: 0.3 })
                        );
                        cube.add(line);
                        
                        scene.add(cube);
                        cubes.push(cube);
                    }
                }
            }
        }

        function createAxes() {
            const axisLength = 4;
            const axisRadius = 0.05;
            
            // X axis (red)
            const xGeom = new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength * 2, 8);
            const xMat = new THREE.MeshPhongMaterial({ color: 0xef4444, transparent: true, opacity: 0.6 });
            const xAxis = new THREE.Mesh(xGeom, xMat);
            xAxis.rotation.z = Math.PI / 2;
            scene.add(xAxis);
            
            // Y axis (green)
            const yGeom = new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength * 2, 8);
            const yMat = new THREE.MeshPhongMaterial({ color: 0x10b981, transparent: true, opacity: 0.6 });
            const yAxis = new THREE.Mesh(yGeom, yMat);
            scene.add(yAxis);
            
            // Z axis (blue)
            const zGeom = new THREE.CylinderGeometry(axisRadius, axisRadius, axisLength * 2, 8);
            const zMat = new THREE.MeshPhongMaterial({ color: 0x06b6d4, transparent: true, opacity: 0.6 });
            const zAxis = new THREE.Mesh(zGeom, zMat);
            zAxis.rotation.x = Math.PI / 2;
            scene.add(zAxis);
        }

        function createAxisSpheres() {
            // X, Y, Z positions for highlighting
            const positions = [
                {pos: [2, 0, 0], color: 0xef4444},  // +X
                {pos: [-2, 0, 0], color: 0xef4444}, // -X
                {pos: [0, 2, 0], color: 0x10b981},  // +Y
                {pos: [0, -2, 0], color: 0x10b981}, // -Y
                {pos: [0, 0, 2], color: 0x06b6d4},  // +Z
                {pos: [0, 0, -2], color: 0x06b6d4}  // -Z
            ];
            
            positions.forEach(p => {
                const sphere = new THREE.Mesh(
                    new THREE.SphereGeometry(0.2, 16, 16),
                    new THREE.MeshPhongMaterial({
                        color: p.color,
                        transparent: true,
                        opacity: 0.3,
                        emissive: p.color,
                        emissiveIntensity: 0.2
                    })
                );
                sphere.position.set(p.pos[0], p.pos[1], p.pos[2]);
                scene.add(sphere);
                axisSpheres.push(sphere);
            });
        }

        function updateVisualization() {
            const currentState = T0_LATTICE[currentStateIndex];
            
            // Reset all cubes
            cubes.forEach(cube => {
                cube.material.opacity = 0.1;
                cube.material.color.setHex(0x334155);
                cube.material.emissive.setHex(0x000000);
            });
            
            // Reset axis spheres
            axisSpheres.forEach(sphere => {
                sphere.material.opacity = 0.3;
                sphere.material.emissiveIntensity = 0.2;
            });
            
            // Highlight current cube
            const [x, y, z] = currentState.state;
            const cubeIndex = (x + 1) * 9 + (y + 1) * 3 + (z + 1);
            const targetCube = cubes[cubeIndex];
            
            // Color based on k-class
            let color;
            switch(currentState.k) {
                case 0: color = 0x06b6d4; break; // Cyan for N0
                case 1: color = 0x3b82f6; break; // Blue for N1
                case 2: color = 0x10b981; break; // Green for N2/N4
                case 3: color = 0xa855f7; break; // Purple for N3/N5
            }
            
            targetCube.material.opacity = 0.9;
            targetCube.material.color.setHex(color);
            targetCube.material.emissive.setHex(color);
            targetCube.material.emissiveIntensity = 0.5;
            
            // Highlight active axes based on signs
            const signs = currentState.signs;
            if (signs[0] !== 0) {
                const idx = signs[0] > 0 ? 0 : 1;
                axisSpheres[idx].material.opacity = 0.8;
                axisSpheres[idx].material.emissiveIntensity = 0.6;
            }
            if (signs[1] !== 0) {
                const idx = signs[1] > 0 ? 2 : 3;
                axisSpheres[idx].material.opacity = 0.8;
                axisSpheres[idx].material.emissiveIntensity = 0.6;
            }
            if (signs[2] !== 0) {
                const idx = signs[2] > 0 ? 4 : 5;
                axisSpheres[idx].material.opacity = 0.8;
                axisSpheres[idx].material.emissiveIntensity = 0.6;
            }
            
            // Update UI
            const stateStr = `(${signs[0] === 1 ? '+0' : signs[0] === -1 ? '−0' : '0'}, ${signs[1] === 1 ? '+0' : signs[1] === -1 ? '−0' : '0'}, ${signs[2] === 1 ? '+0' : signs[2] === -1 ? '−0' : '0'})`;
            document.getElementById('currentState').textContent = stateStr;
            document.getElementById('stateIndex').textContent = `${currentStateIndex + 1}/27`;
            document.getElementById('kClass').textContent = currentState.name;
            document.getElementById('alphaValue').textContent = currentState.alpha.toFixed(3);
            document.getElementById('betaValue').textContent = currentState.beta.toFixed(3);
            document.getElementById('gammaValue').textContent = currentState.gamma.toFixed(3);
            
            // Show separation status
            const separatedAxes = [];
            if (signs[0] !== 0) separatedAxes.push('x');
            if (signs[1] !== 0) separatedAxes.push('y');
            if (signs[2] !== 0) separatedAxes.push('z');
            document.getElementById('separation').textContent = separatedAxes.length > 0 ? separatedAxes.join(', ') : 'None';
        }

        function nextState() {
            currentStateIndex = (currentStateIndex + 1) % T0_LATTICE.length;
            updateVisualization();
        }

        function jumpToState(index) {
            currentStateIndex = index;
            updateVisualization();
        }

        function togglePlay() {
            isPlaying = !isPlaying;
            const btn = document.getElementById('playBtn');
            btn.textContent = isPlaying ? '⏸️ Pause' : '▶️ Play';
            btn.classList.toggle('active');
            
            if (isPlaying) {
                startAnimation();
            } else {
                stopAnimation();
            }
        }

        function reset() {
            currentStateIndex = 0;
            updateVisualization();
        }

        function updateSpeed() {
            const speed = document.getElementById('speedSlider').value;
            if (isPlaying) {
                stopAnimation();
                startAnimation();
            }
        }

        function startAnimation() {
            const speed = document.getElementById('speedSlider').value;
            animationInterval = setInterval(() => {
                if (isPlaying) {
                    nextState();
                }
            }, speed);
        }

        function stopAnimation() {
            clearInterval(animationInterval);
        }

        function animate() {
            requestAnimationFrame(animate);
            scene.rotation.y += 0.002;
            renderer.render(scene, camera);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        init();
    </script>
</body>
</html>